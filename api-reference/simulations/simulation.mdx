---
title: "Simulation"
description: "Type definition for packaging components with MCP metadata and example data for testing and development."
---

import CreateSimulation from '/snippets/create-simulation.mdx';

## Overview

`Simulation` is a TypeScript interface that packages a React component with its MCP
(Model Context Protocol) metadata and example data.

Each simulation represents a complete
tool experience in the simulator and MCP server, combining the component, tool definition,
resource definition, and mock tool call data.

Simulations are used for local testing with the ChatGPT Simulator and for configuring MCP servers.

## Import

```tsx
import type { Simulation } from 'sunpeak';
```

## Basic Usage

<CreateSimulation />

## Properties

<ResponseField name="resourceComponent" type="React.ComponentType" required>
  The React component to render in the simulator (the MCP server renders the built component in `dist/`).
  This component implements the UI for your tool.
</ResponseField>

<ResponseField name="userMessage" type="string">
  A decorative message shown in the simulator interface. Has no functional purpose and is used only for UI presentation.
</ResponseField>

<ResponseField name="simulationGlobals" type="SimulationGlobals">
  Configuration for the simulator environment including theme, locale, display mode, and other runtime values. See [SimulationGlobals](#simulationglobals-interface) below for details.
</ResponseField>

<ResponseField name="tool" type="Tool" required>
  Official MCP SDK Tool type used in the ListTools response. Defines the tool's name, description, input schema, and metadata including OpenAI-specific annotations.

  **Key properties:**
  - `name`: Unique identifier for the tool.
  - `description`: Human-readable description.
  - `inputSchema`: JSON Schema for tool input validation.
  - `title`: Display name.
  - `annotations`: Tool behavior hints (e.g., `readOnlyHint`).
  - `_meta`: Platform-specific metadata. Not shown to the AI. For OpenAI/ChatGPT:
    - `openai/outputTemplate` (string, required): Resource URI to display when tool is invoked (e.g., `ui://MyComponentResource`). Must match a resource URI.
    - `openai/toolInvocation/invoking` (string): Status message shown while tool is executing (e.g., "Loading data...").
    - `openai/toolInvocation/invoked` (string): Status message shown after tool completes (e.g., "Data loaded").
    - `openai/widgetAccessible` (boolean): Whether the widget can be accessed/rendered in ChatGPT.
    - `openai/resultCanProduceWidget` (boolean): Whether the tool result can produce a widget UI.
</ResponseField>

<ResponseField name="resource" type="Resource" required>
  Official MCP SDK Resource type used in the ListResources response. Defines the resource URI, name, and metadata.

  **Required:** Resource metadata must be defined in a separate `-resource.meta.ts` file in the `resources`
  directory. You can either duplicate those values here or import the meta file and put it into your simulation.
  This keeps metadata server-safe (no React/CSS imports), allows the build to export it, and enables deployment.

  **Key properties:**
  - `uri`: Resource URI. Use `ui://` + your component name (e.g., `ui://MyComponentResource`).
  - `name`: Name of the resource (machine).
  - `title`: Name of the resource (human readable).
  - `description`: Human-readable description.
  - `mimeType`: Always `text/html+skybridge` for UI resources.
  - `_meta`: Additional metadata. Use `defaultWidgetMeta` from `widget-config.ts` and override as needed:
    - `openai/widgetDomain` (string): The domain where your widget should link via the "Open in App" button (e.g., `https://yourdomain.com`).
    - `openai/widgetCSP` (object): Content Security Policy configuration for your widget:
      - `connect_domains` (string[]): Domains your widget can make API requests to (e.g., `['https://api.yourdomain.com']`).
      - `resource_domains` (string[]): Domains your widget can load images and other resources from (e.g., `['https://cdn.yourdomain.com', 'https://images.unsplash.com']`).
</ResponseField>

<ResponseField name="toolCall" type="SimulationCallToolResult">
  Mock data for the MCP CallTool response. Supplies `structuredContent` and `_meta` values to your Resource.
  See [SimulationCallToolResult](#simulationcalltoolresult-interface) below for details.
</ResponseField>

## Related Types

### SimulationGlobals Interface

Configures the simulator environment with initial values for development and testing.
These values are used to initialize the local simulator, but they are unused during
platform testing (ChatGPT owns the global state).

<ResponseField name="theme" type="Theme">
  Theme setting: `'light'` or `'dark'`.
</ResponseField>

<ResponseField name="userAgent" type="UserAgent">
  Device/platform information.
</ResponseField>

<ResponseField name="locale" type="string">
  Locale string (e.g., `'en-US'`).
</ResponseField>

<ResponseField name="maxHeight" type="number">
  Maximum widget height in pixels.
</ResponseField>

<ResponseField name="displayMode" type="DisplayMode">
  Display mode: `'full'` or `'compact'`.
</ResponseField>

<ResponseField name="safeArea" type="SafeArea">
  Safe area insets.
</ResponseField>

<ResponseField name="view" type="View | null">
  Current view context.
</ResponseField>

<ResponseField name="toolInput" type="Record<string, unknown>">
  Tool input parameters.
</ResponseField>

<ResponseField name="widgetState" type="Record<string, unknown> | null">
  Widget state data.
</ResponseField>

**Note:** `toolOutput` (`structuredContent`) and `toolResponseMetadata` (`_meta`) are set in
`SimulationCallToolResult` instead of `SimulationGlobals`. This is to better align with the MCP
specification, and also to provide those values to the MCP server (`SimulationGlobals` are not).

### SimulationCallToolResult Interface

Subset of the MCP CallTool response used in simulations to provide mock structured content and metadata.

<ResponseField name="structuredContent" type="Record<string, unknown> | null">
  Tool output data.
</ResponseField>

<ResponseField name="_meta" type="Record<string, unknown>">
  Response metadata.
</ResponseField>

## Example - Resource Meta File

Each resource requires a companion `.meta.ts` file containing server-safe metadata:

```ts
// src/resources/albums-resource.meta.ts
import { defaultWidgetMeta } from '../simulations/widget-config';

export const albumsResourceMeta = {
  uri: 'ui://AlbumsResource',
  name: 'albums',
  title: 'Albums',
  description: 'Show photo albums widget markup',
  mimeType: 'text/html+skybridge',
  _meta: {
    ...defaultWidgetMeta,
  },
} as const;
```

## Example - Simulation with Globals and Data

The simulation imports the resource metadata from the meta file:

```tsx
// src/simulations/albums-simulation.ts
import { albumsResourceMeta } from '../resources/albums-resource.meta';

export const albumsSimulation: Simulation = {
  resourceComponent: Albums,
  userMessage: 'Show me some albums',

  simulationGlobals: {
    theme: 'dark',
    displayMode: 'full',
    locale: 'en-US',
  },

  tool: {
    name: 'show-albums',
    description: 'Display a collection of albums',
    inputSchema: {
      type: 'object',
      properties: {
        genre: { type: 'string' }
      },
      additionalProperties: false
    },
    title: 'Show Albums',
    annotations: { readOnlyHint: true },
    _meta: {
      'openai/outputTemplate': 'ui://AlbumsResource',
      'openai/widgetAccessible': true,
      'openai/resultCanProduceWidget': true,
    },
  },

  // Imported from resource meta file
  resource: albumsResourceMeta,

  toolCall: {
    structuredContent: {
      albums: [
        { title: 'Album 1', artist: 'Artist 1' },
        { title: 'Album 2', artist: 'Artist 2' },
      ]
    },
    _meta: { count: 2 },
  },
};
```
