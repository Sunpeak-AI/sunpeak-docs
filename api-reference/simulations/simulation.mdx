---
title: "Simulation"
description: "JSON files that define MCP metadata and example data for testing and development."
---

import CreateSimulation from '/snippets/create-simulation.mdx';

## Overview

Simulations are JSON files that define MCP (Model Context Protocol) metadata and example data
for testing your resources in the ChatGPT Simulator and MCP server.

Each simulation represents a complete tool experience, combining the tool definition,
mock tool call data, and optional simulator configuration. The resource component and
resource metadata are automatically discovered based on file naming conventions.

## File Naming Convention

Simulation files follow the pattern:

```
src/simulations/{resource}-{tool}-simulation.json
```

For example:
- `albums-show-simulation.json` - linked to `albums-resource.tsx` and `albums-resource.json`
- `counter-increment-simulation.json` - linked to `counter-resource.tsx` and `counter-resource.json`
- `map-search-simulation.json` - linked to `map-resource.tsx` and `map-resource.json`

The `{resource}` prefix determines which resource files are automatically linked:
- **Component**: `src/resources/{resource}-resource.tsx`
- **Metadata**: `src/resources/{resource}-resource.json`

You can have multiple simulations per resource (e.g., `albums-show-simulation.json` and `albums-edit-simulation.json`).

## Basic Usage

<CreateSimulation />

## Properties

<ResponseField name="userMessage" type="string">
  A decorative message shown in the simulator interface. Has no functional purpose and is used only for UI presentation.
</ResponseField>

<ResponseField name="simulationGlobals" type="SimulationGlobals">
  Configuration for the simulator environment including theme, locale, display mode, and other runtime values. See [SimulationGlobals](#simulationglobals-interface) below for details.
</ResponseField>

<ResponseField name="tool" type="Tool" required>
  Official MCP SDK Tool type used in the ListTools response. Defines the tool's name, description, input schema, and metadata including OpenAI-specific annotations.

  **Key properties**:
  - `name`: Unique identifier for the tool.
  - `description`: Human-readable description.
  - `inputSchema`: JSON Schema for tool input validation.
  - `title`: Display name.
  - `annotations`: Tool behavior hints (e.g., `readOnlyHint`).
  - `_meta`: Platform-specific metadata. Not shown to the AI. For OpenAI/ChatGPT:
    - `openai/toolInvocation/invoking` (string): Status message shown while tool is executing (e.g., "Loading data...").
    - `openai/toolInvocation/invoked` (string): Status message shown after tool completes (e.g., "Data loaded").
    - `openai/widgetAccessible` (boolean): Whether the widget can be accessed/rendered in ChatGPT.
    - `openai/resultCanProduceWidget` (boolean): Whether the tool result can produce a widget UI.
</ResponseField>

<ResponseField name="toolCall" type="SimulationCallToolResult">
  Mock data for the MCP CallTool response. Supplies `structuredContent` and `_meta` values to your Resource.
  See [SimulationCallToolResult](#simulationcalltoolresult-interface) below for details.
</ResponseField>

## Auto-Discovery

Sunpeak automatically discovers and links simulations to resources based on file naming:

1. **Simulation files** are discovered via glob pattern: `src/simulations/*-simulation.json`
2. **Resource matching** uses the longest prefix match. For `albums-show-simulation.json`:
   - Extracts key: `albums-show`
   - Finds resource: `albums` (matches `albums-resource.tsx` and `albums-resource.json`)
3. **No manual imports** needed - everything is wired automatically

This means you never need to:
- Import resource metadata into simulations
- Specify `resource` in the simulation (auto-linked)
- Maintain an index file of simulations

## Related Types

### SimulationGlobals Interface

Configures the simulator environment with initial values for development and testing.
These values are used to initialize the local simulator, but they are unused during
platform testing (ChatGPT owns the global state).

<ResponseField name="theme" type="Theme">
  Theme setting: `'light'` or `'dark'`.
</ResponseField>

<ResponseField name="userAgent" type="UserAgent">
  Device/platform information.
</ResponseField>

<ResponseField name="locale" type="string">
  Locale string (e.g., `'en-US'`).
</ResponseField>

<ResponseField name="maxHeight" type="number">
  Maximum widget height in pixels.
</ResponseField>

<ResponseField name="displayMode" type="DisplayMode">
  Display mode: `'full'` or `'compact'`.
</ResponseField>

<ResponseField name="safeArea" type="SafeArea">
  Safe area insets.
</ResponseField>

<ResponseField name="view" type="View | null">
  Current view context.
</ResponseField>

<ResponseField name="toolInput" type="Record<string, unknown>">
  Tool input parameters.
</ResponseField>

<ResponseField name="widgetState" type="Record<string, unknown> | null">
  Widget state data.
</ResponseField>

**Note**: `toolOutput` (`structuredContent`) and `toolResponseMetadata` (`_meta`) are set in
`SimulationCallToolResult` instead of `SimulationGlobals`. This is to better align with the MCP
specification, and also to provide those values to the MCP server (`SimulationGlobals` are not).

### SimulationCallToolResult Interface

Subset of the MCP CallTool response used in simulations to provide mock structured content and metadata.

<ResponseField name="structuredContent" type="Record<string, unknown> | null">
  Tool output data passed to your resource component via `useWidgetProps()`.
</ResponseField>

<ResponseField name="_meta" type="Record<string, unknown>">
  Response metadata passed to your resource component via `useToolResponseMetadata()`.
</ResponseField>

## Example - Resource JSON File

Each resource requires a companion `.json` file containing metadata:

```json
// src/resources/albums-resource.json
{
  "name": "albums",
  "title": "Albums",
  "description": "Show photo albums widget markup",
  "mimeType": "text/html+skybridge",
  "_meta": {
    "openai/widgetDomain": "https://example.com",
    "openai/widgetCSP": {
      "connect_domains": [],
      "resource_domains": ["https://*.oaistatic.com"]
    }
  }
}
```

## Example - Simulation JSON File

Simulations are pure JSON files. The resource is automatically linked based on the filename prefix:

```json
// src/simulations/albums-show-simulation.json
{
  "userMessage": "Show me some albums",
  "tool": {
    "name": "show-albums",
    "description": "Display a collection of photo albums",
    "inputSchema": {
      "type": "object",
      "properties": {},
      "additionalProperties": false
    },
    "title": "Show Albums",
    "annotations": { "readOnlyHint": true },
    "_meta": {
      "openai/toolInvocation/invoking": "Loading albums",
      "openai/toolInvocation/invoked": "Albums loaded",
      "openai/widgetAccessible": true,
      "openai/resultCanProduceWidget": true
    }
  },
  "toolCall": {
    "structuredContent": {
      "albums": [
        {
          "id": "summer-escape",
          "title": "Summer Vacation",
          "cover": "https://example.com/cover.jpg",
          "photos": [
            { "id": "1", "title": "Beach", "url": "https://example.com/beach.jpg" }
          ]
        }
      ]
    },
    "_meta": {}
  }
}
```

## Example - Simulation with Globals

You can include `simulationGlobals` to configure the simulator environment:

```json
// src/simulations/counter-show-simulation.json
{
  "userMessage": "Help me count something",
  "simulationGlobals": {
    "theme": "dark",
    "displayMode": "pip",
    "locale": "en-US",
    "maxHeight": 400
  },
  "tool": {
    "name": "show-counter",
    "description": "Show a simple counter",
    "inputSchema": { "type": "object", "properties": {}, "additionalProperties": false },
    "title": "Show Counter",
    "annotations": { "readOnlyHint": true },
    "_meta": {
      "openai/widgetAccessible": true,
      "openai/resultCanProduceWidget": true
    }
  },
  "toolCall": {
    "structuredContent": null,
    "_meta": {}
  }
}
```

## Multiple Simulations Per Resource

You can create multiple simulations for the same resource to test different scenarios:

```
src/simulations/
  albums-show-simulation.json      # Default view
  albums-empty-simulation.json     # Empty state
  albums-error-simulation.json     # Error state
```

Each simulation can have different `toolCall.structuredContent` to test various data scenarios.
